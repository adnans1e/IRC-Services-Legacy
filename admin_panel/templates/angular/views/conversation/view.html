<section class="content-header" ng-controller="ContentHeaderController as chctrl">
    <h1>
        {$ chctrl.state.data.title $}
        <small>{$ ctrl.region.name$}</small>
    </h1>
</section>

<section class="content">
    <div class="row">
        <div class="col-md-6 col-sm-6 col-xs-12">
            <div class="box box-primary direct-chat direct-chat-primary">
                <div class="box-header with-border">
                    <h3 class="box-title">Direct Chat</h3>

                    <div class="box-tools pull-right hide">
                        <span data-toggle="tooltip" title="" class="badge bg-light-blue"
                              data-original-title=" New Messages"></span>
                    </div>
                </div>
                <div class="box-body">
                    <div class="direct-chat-messages" scroll-to-bottom="">
                        <div class="direct-chat-msg" ng-repeat="m in ctrl.messages"
                             ng-class="{right: m.from_object_id == '950581228335358'}">
                            <div class="direct-chat-info clearfix">
                                <span class="direct-chat-name pull-left">{$ m.from_name $} </span>
                                <span class="direct-chat-timestamp pull-right">{$ m.created|formatDate $}</span>
                            </div>
                            <div class="direct-chat-text" style="white-space: pre-wrap" ng-bind="m.message||' '"
                                 ng-style="{
                             direction: ['ar','fa'].indexOf(m.analysis.language_code) > -1 ? 'rtl':'ltr'
                            }"></div>
                        </div>
                    </div>
                </div>
                <div class="box-footer">
                    <form ng-submit="ctrl.sendMessage()">
                        <div class="input-group">
                            <input type="text" name="message" ng-model="ctrl.message" placeholder="Type Message ..."
                                   class="form-control">
                      <span class="input-group-btn">
                        <button type="submit" class="btn btn-primary btn-flat">Send</button>
                      </span>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <div class="col-md-6 col-sm-6 col-xs-12">
            <div class="box">
                <div class="box-header">
                    <h3 class="box-title">Entities</h3>

                    <div class="box-tools">

                    </div>
                </div>
                <div class="box-body no-padding">
                    <table class="table">
                        <tbody>
                        <tr>
                            <th>Tag</th>
                            <th>Entity</th>
                            <th></th>
                        </tr>
                        <tr ng-repeat="e in ctrl.entities">
                            <td>{$ e.tag $}</td>
                            <td>{$ e.text $}</td>
                            <td><a href="http://translate.google.com/#auto/en/{$ e.text|escape $}" target="_blank">
                                {$ e.text $}
                            </a></td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-xs-12">
            <div class="box">
                <div class="box-footer">
                    <div class="btn-group pull-left">
                        <a href="https://www.facebook.com/{$ ctrl.object.from_object_id $}" target="_blank"
                           class="btn btn-success" ng-if="ctrl.object.from_object_id">
                            Open Profile
                        </a>
                    </div>
                    <div class="btn-group pull-right">
                        <button type="button" class="btn btn-primary"
                                ng-click="ctrl.runAnalysis()">Run Analysis
                        </button>
                        <button type="button" class="btn btn-primary"
                                ng-click="ctrl.updateConversation()">Update
                        </button>
                    </div>
                </div>
            </div>

        </div>
    </div>
</section>